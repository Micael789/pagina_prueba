{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jejef\\\\OneDrive\\\\windsurf\\\\proyecto-vinculacion-acciones-QR\\\\frontend\\\\src\\\\components\\\\ScanPage.js\",\n  _s = $RefreshSig$();\n/**\n * Página principal de escaneo de QR\n * Muestra información de unidad y acciones disponibles\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { useAuth } from '../services/AuthContext';\nimport { useSync } from '../services/SyncContext';\nimport { apiService } from '../services/apiService';\nimport UnitInfo from './UnitInfo';\nimport ActionModal from './ActionModal';\nimport QRScanner from './QRScanner';\nimport EventHistory from './EventHistory';\nimport confetti from 'canvas-confetti';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction ScanPage() {\n  _s();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const {\n    user,\n    logout\n  } = useAuth();\n  const {\n    getSyncStats,\n    syncPendingEvents\n  } = useSync();\n  const [unit, setUnit] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [showScanner, setShowScanner] = useState(false);\n  const [selectedAction, setSelectedAction] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const unitId = searchParams.get('unit_id');\n  const syncStats = getSyncStats();\n\n  // Cargar unidad al cambiar el unit_id\n  useEffect(() => {\n    if (unitId) {\n      loadUnit(unitId);\n    }\n  }, [unitId]);\n\n  /**\n   * Carga información de la unidad\n   */\n  const loadUnit = async id => {\n    setLoading(true);\n    setError('');\n    try {\n      const response = await apiService.getUnit(id);\n      setUnit(response.data);\n\n      // Efecto de confetti para unidades importantes\n      if (response.data.current_status === 'reparacion') {\n        confetti({\n          particleCount: 50,\n          spread: 70,\n          origin: {\n            y: 0.6\n          }\n        });\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Error cargando la unidad');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /**\n   * Maneja el resultado del escaneo QR\n   */\n  const handleQRResult = result => {\n    try {\n      // Parsear URL del QR\n      const url = new URL(result);\n      const scannedUnitId = url.searchParams.get('unit_id');\n      if (scannedUnitId) {\n        setSearchParams({\n          unit_id: scannedUnitId\n        });\n        setShowScanner(false);\n      } else {\n        setError('QR inválido: no contiene unit_id');\n      }\n    } catch (err) {\n      setError('QR inválido: formato incorrecto');\n    }\n  };\n\n  /**\n   * Maneja la ejecución de una acción\n   */\n  const handleActionComplete = async () => {\n    setSelectedAction(null);\n    // Recargar unidad para ver cambios\n    if (unitId) {\n      await loadUnit(unitId);\n    }\n\n    // Efecto visual de éxito\n    confetti({\n      particleCount: 100,\n      spread: 70,\n      origin: {\n        y: 0.6\n      }\n    });\n  };\n\n  /**\n   * Simula escaneo de QR con unidades de prueba\n   */\n  const simulateQR = testUnitId => {\n    setSearchParams({\n      unit_id: testUnitId\n    });\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-center min-h-screen\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-spinner mx-auto mb-4\",\n            style: {\n              width: '2rem',\n              height: '2rem'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600\",\n            children: \"Cargando unidad...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mobile-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-bold text-gray-900\",\n          children: \"QR Units\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600\",\n          children: (user === null || user === void 0 ? void 0 : user.role) === 'admin' ? 'Administrador' : (user === null || user === void 0 ? void 0 : user.role) === 'warehouse' ? 'Almacén' : (user === null || user === void 0 ? void 0 : user.role) === 'delivery' ? 'Entrega' : (user === null || user === void 0 ? void 0 : user.role) === 'cleaner' ? 'Limpieza' : (user === null || user === void 0 ? void 0 : user.role) === 'collection' ? 'Recolección' : (user === null || user === void 0 ? void 0 : user.role) === 'repair' ? 'Reparación' : user === null || user === void 0 ? void 0 : user.role\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [syncStats.pending > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: syncPendingEvents,\n          className: \"relative\",\n          disabled: syncStats.syncing,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white text-xs font-bold\",\n            children: syncStats.pending\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 15\n          }, this), syncStats.syncing && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 loading-spinner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: logout,\n          className: \"btn btn-secondary text-xs px-3 py-1\",\n          children: \"Salir\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), !unitId ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card mb-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center py-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-10 h-10 text-blue-600\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 16h4m-4 0v3m0 0h.01M20 8v.01\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"card-title mb-2\",\n            children: \"Escanear C\\xF3digo QR\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"card-subtitle mb-6\",\n            children: \"Escanea el c\\xF3digo QR de una unidad para ver su informaci\\xF3n y acciones disponibles\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowScanner(true),\n            className: \"btn btn-primary btn-lg mb-4\",\n            children: \"\\uD83D\\uDCF1 Abrir Esc\\xE1ner QR\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"card-title\",\n            children: \"Unidades de Prueba\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"card-subtitle\",\n            children: \"Selecciona una unidad para simular escaneo QR\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-3\",\n          children: ['UN001', 'UN002', 'UN003', 'UN004', 'UN005', 'UN006'].map(id => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => simulateQR(id),\n            className: \"btn btn-secondary\",\n            children: id\n          }, id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 13\n      }, this), unit && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(UnitInfo, {\n          unit: unit,\n          onActionSelect: setSelectedAction,\n          onShowHistory: () => setShowHistory(true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 flex gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSearchParams({}),\n            className: \"btn btn-secondary flex-1\",\n            children: \"\\uD83D\\uDD0D Escanear Otro QR\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => loadUnit(unitId),\n            className: \"btn btn-primary\",\n            children: \"\\uD83D\\uDD04\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 9\n    }, this), showScanner && /*#__PURE__*/_jsxDEV(QRScanner, {\n      onResult: handleQRResult,\n      onClose: () => setShowScanner(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 9\n    }, this), selectedAction && unit && /*#__PURE__*/_jsxDEV(ActionModal, {\n      unit: unit,\n      action: selectedAction,\n      onComplete: handleActionComplete,\n      onCancel: () => setSelectedAction(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 9\n    }, this), showHistory && unit && /*#__PURE__*/_jsxDEV(EventHistory, {\n      unitId: unit.unit_id,\n      onClose: () => setShowHistory(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 124,\n    columnNumber: 5\n  }, this);\n}\n_s(ScanPage, \"48LjjIsEHbiCf2gS7IKhfvZIHj8=\", false, function () {\n  return [useSearchParams, useAuth, useSync];\n});\n_c = ScanPage;\nexport default ScanPage;\nvar _c;\n$RefreshReg$(_c, \"ScanPage\");","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","useAuth","useSync","apiService","UnitInfo","ActionModal","QRScanner","EventHistory","confetti","jsxDEV","_jsxDEV","Fragment","_Fragment","ScanPage","_s","searchParams","setSearchParams","user","logout","getSyncStats","syncPendingEvents","unit","setUnit","loading","setLoading","error","setError","showScanner","setShowScanner","selectedAction","setSelectedAction","showHistory","setShowHistory","unitId","get","syncStats","loadUnit","id","response","getUnit","data","current_status","particleCount","spread","origin","y","err","_err$response","_err$response$data","message","handleQRResult","result","url","URL","scannedUnitId","unit_id","handleActionComplete","simulateQR","testUnitId","className","children","style","width","height","fileName","_jsxFileName","lineNumber","columnNumber","role","pending","onClick","disabled","syncing","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","map","onActionSelect","onShowHistory","onResult","onClose","action","onComplete","onCancel","_c","$RefreshReg$"],"sources":["C:/Users/jejef/OneDrive/windsurf/proyecto-vinculacion-acciones-QR/frontend/src/components/ScanPage.js"],"sourcesContent":["/**\n * Página principal de escaneo de QR\n * Muestra información de unidad y acciones disponibles\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { useAuth } from '../services/AuthContext';\nimport { useSync } from '../services/SyncContext';\nimport { apiService } from '../services/apiService';\nimport UnitInfo from './UnitInfo';\nimport ActionModal from './ActionModal';\nimport QRScanner from './QRScanner';\nimport EventHistory from './EventHistory';\nimport confetti from 'canvas-confetti';\n\nfunction ScanPage() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const { user, logout } = useAuth();\n  const { getSyncStats, syncPendingEvents } = useSync();\n  \n  const [unit, setUnit] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [showScanner, setShowScanner] = useState(false);\n  const [selectedAction, setSelectedAction] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n\n  const unitId = searchParams.get('unit_id');\n  const syncStats = getSyncStats();\n\n  // Cargar unidad al cambiar el unit_id\n  useEffect(() => {\n    if (unitId) {\n      loadUnit(unitId);\n    }\n  }, [unitId]);\n\n  /**\n   * Carga información de la unidad\n   */\n  const loadUnit = async (id) => {\n    setLoading(true);\n    setError('');\n    \n    try {\n      const response = await apiService.getUnit(id);\n      setUnit(response.data);\n      \n      // Efecto de confetti para unidades importantes\n      if (response.data.current_status === 'reparacion') {\n        confetti({\n          particleCount: 50,\n          spread: 70,\n          origin: { y: 0.6 }\n        });\n      }\n    } catch (err) {\n      setError(err.response?.data?.message || 'Error cargando la unidad');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /**\n   * Maneja el resultado del escaneo QR\n   */\n  const handleQRResult = (result) => {\n    try {\n      // Parsear URL del QR\n      const url = new URL(result);\n      const scannedUnitId = url.searchParams.get('unit_id');\n      \n      if (scannedUnitId) {\n        setSearchParams({ unit_id: scannedUnitId });\n        setShowScanner(false);\n      } else {\n        setError('QR inválido: no contiene unit_id');\n      }\n    } catch (err) {\n      setError('QR inválido: formato incorrecto');\n    }\n  };\n\n  /**\n   * Maneja la ejecución de una acción\n   */\n  const handleActionComplete = async () => {\n    setSelectedAction(null);\n    // Recargar unidad para ver cambios\n    if (unitId) {\n      await loadUnit(unitId);\n    }\n    \n    // Efecto visual de éxito\n    confetti({\n      particleCount: 100,\n      spread: 70,\n      origin: { y: 0.6 }\n    });\n  };\n\n  /**\n   * Simula escaneo de QR con unidades de prueba\n   */\n  const simulateQR = (testUnitId) => {\n    setSearchParams({ unit_id: testUnitId });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"mobile-container\">\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <div className=\"text-center\">\n            <div className=\"loading-spinner mx-auto mb-4\" style={{ width: '2rem', height: '2rem' }}></div>\n            <p className=\"text-gray-600\">Cargando unidad...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mobile-container\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div>\n          <h1 className=\"text-xl font-bold text-gray-900\">QR Units</h1>\n          <p className=\"text-sm text-gray-600\">\n            {user?.role === 'admin' ? 'Administrador' :\n             user?.role === 'warehouse' ? 'Almacén' :\n             user?.role === 'delivery' ? 'Entrega' :\n             user?.role === 'cleaner' ? 'Limpieza' :\n             user?.role === 'collection' ? 'Recolección' :\n             user?.role === 'repair' ? 'Reparación' : user?.role}\n          </p>\n        </div>\n        \n        <div className=\"flex items-center gap-2\">\n          {/* Indicador de eventos pendientes */}\n          {syncStats.pending > 0 && (\n            <button\n              onClick={syncPendingEvents}\n              className=\"relative\"\n              disabled={syncStats.syncing}\n            >\n              <div className=\"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white text-xs font-bold\">\n                {syncStats.pending}\n              </div>\n              {syncStats.syncing && (\n                <div className=\"absolute inset-0 loading-spinner\"></div>\n              )}\n            </button>\n          )}\n          \n          <button\n            onClick={logout}\n            className=\"btn btn-secondary text-xs px-3 py-1\"\n          >\n            Salir\n          </button>\n        </div>\n      </div>\n\n      {/* Contenido principal */}\n      {!unitId ? (\n        <div className=\"text-center\">\n          <div className=\"card mb-6\">\n            <div className=\"text-center py-8\">\n              <div className=\"w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-10 h-10 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 16h4m-4 0v3m0 0h.01M20 8v.01\"></path>\n                </svg>\n              </div>\n              <h2 className=\"card-title mb-2\">Escanear Código QR</h2>\n              <p className=\"card-subtitle mb-6\">\n                Escanea el código QR de una unidad para ver su información y acciones disponibles\n              </p>\n              \n              <button\n                onClick={() => setShowScanner(true)}\n                className=\"btn btn-primary btn-lg mb-4\"\n              >\n                📱 Abrir Escáner QR\n              </button>\n            </div>\n          </div>\n\n          {/* Unidades de prueba */}\n          <div className=\"card\">\n            <div className=\"card-header\">\n              <h3 className=\"card-title\">Unidades de Prueba</h3>\n              <p className=\"card-subtitle\">\n                Selecciona una unidad para simular escaneo QR\n              </p>\n            </div>\n            \n            <div className=\"grid grid-cols-2 gap-3\">\n              {['UN001', 'UN002', 'UN003', 'UN004', 'UN005', 'UN006'].map(id => (\n                <button\n                  key={id}\n                  onClick={() => simulateQR(id)}\n                  className=\"btn btn-secondary\"\n                >\n                  {id}\n                </button>\n              ))}\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div>\n          {error && (\n            <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\n              {error}\n            </div>\n          )}\n          \n          {unit && (\n            <>\n              {/* Información de la unidad */}\n              <UnitInfo \n                unit={unit}\n                onActionSelect={setSelectedAction}\n                onShowHistory={() => setShowHistory(true)}\n              />\n              \n              {/* Botones de navegación */}\n              <div className=\"mt-6 flex gap-3\">\n                <button\n                  onClick={() => setSearchParams({})}\n                  className=\"btn btn-secondary flex-1\"\n                >\n                  🔍 Escanear Otro QR\n                </button>\n                \n                <button\n                  onClick={() => loadUnit(unitId)}\n                  className=\"btn btn-primary\"\n                >\n                  🔄\n                </button>\n              </div>\n            </>\n          )}\n        </div>\n      )}\n\n      {/* Modales */}\n      {showScanner && (\n        <QRScanner\n          onResult={handleQRResult}\n          onClose={() => setShowScanner(false)}\n        />\n      )}\n\n      {selectedAction && unit && (\n        <ActionModal\n          unit={unit}\n          action={selectedAction}\n          onComplete={handleActionComplete}\n          onCancel={() => setSelectedAction(null)}\n        />\n      )}\n\n      {showHistory && unit && (\n        <EventHistory\n          unitId={unit.unit_id}\n          onClose={() => setShowHistory(false)}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default ScanPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}